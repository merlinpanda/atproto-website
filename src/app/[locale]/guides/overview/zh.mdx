export const metadata = {
  title: '协议概述',
  description:
    'AT协议技术架构总览',
}

# 协议概述

**认证传输协议**（Authenticated Transfer Protocol，简称**atproto**）是面向大规模社交网络应用的去中心化协议。本文档将介绍AT协议的设计理念。

## 身份体系

用户通过永久性去中心化标识符（DID）建立账户身份，可配置易读的域名句柄。身份信息包含当前托管服务商引用和加密密钥。

## 数据仓库

用户数据通过[签名数据仓库](/guides/data-repos)交换，包含帖子、评论、点赞、关注等记录。

## 网络架构

AT协议采用联邦式架构，账户数据存储于主机服务器（非端到端P2P模式）。该设计确保网络易用性和可靠性，通过标准Web技术（[HTTP](/specs/xrpc)和[WebSockets](/specs/event-stream)）实现服务器间数据同步。

核心服务包括个人数据服务器（PDS）、中继服务（Relays）和应用视图（App Views），以及Feed生成器和标签器等辅助服务。

底层基础组件包含数据仓库、Lexicon模式和DID。我们在[技术博客](https://bsky.social/about/blog/5-5-2023-federation-architecture)中详细阐述了联邦架构的技术决策。

## 互操作性

通过全局模式网络[Lexicon](/specs/lexicon)统一服务间调用规范。服务器通过实现"lexicons"支持功能集，包括核心 `com.atproto.*` 词库（数据同步）和 `app.bsky.*` 词库（社交行为基础）。

区别于Web文档交换，AT协议交换模式化语义信息，使不同系统能互理解数据。这使得客户端可独立于服务器开发界面，无需依赖HTML/JS/CSS渲染代码。

## 扩展性实现

个人数据服务器（PDS）作为云端宿主，负责数据托管、分发、身份管理及服务编排。

中继服务（Relays）汇聚多服务器数据更新形成统一数据流。

应用视图（App Views）提供全网聚合数据，支持大规模指标统计（点赞/转发/关注）、内容发现算法和用户搜索。

该职责分离设计既支持多服务商互操作，又能实现大规模扩展。

## 算法选择

用户可自由选择聚合服务（类似Web搜索引擎）。Feed、标签器和搜索索引可由第三方独立提供，由PDS根据客户端配置路由请求。客户端应用可绑定特定服务（如App Views或强制标签器）。

## 账户可移植性

AT协议确保用户可在PDS服务中断时自主迁移账户。通过[签名数据仓库](/guides/data-repos)存储数据，并由[DID](/guides/identity)进行身份验证。数据仓库类似Git仓库但用于数据库记录，DID提供密钥目录（类似TLS证书体系）。

多数DID文档包含两类公钥：
* **签名密钥**：验证数据仓库，所有DID必备
* **轮换密钥**：控制DID文档更新（PLC DID方法支持，DID Web不支持）

签名密钥委托PDS管理，轮换密钥可由用户自主控制（如纸质密钥），实现无原服务商协助的账户迁移。

用户数据可备份至本地设备或第三方镜像服务。当PDS不可用时，用户可通过更新DID文档并上传备份实现服务迁移。

## 言论传播与审核

AT协议采用"言论"与"传播"分层模型：
* **言论层**保持开放，确保话语权去中心化
* **传播层**构建于上层，支持灵活扩展

基础层（数据仓库+联邦网络）创建公共言论空间（类似网站托管），索引服务实现内容传播（类似搜索引擎）。

## 技术规范

核心规范包括：
- [认证传输协议](/specs/atp)
- [DID](/specs/did)与[句柄](/specs/handle)
- [数据仓库](/specs/repository)与[数据模型](/specs/data-model)
- [Lexicon](/specs/lexicon)
- [HTTP API (XRPC)](/specs/xrpc)与[事件流](/specs/event-stream)
